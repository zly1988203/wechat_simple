var dataUtils={createData:function(t){var e=[];return t.forEach(function(t,n){for(var i=0,a=new Date(2017,t,0).getDate(),r=[],c=0;c<a;c++)(i=parseInt(10*Math.random().toFixed(2))+c+n)<=a&&r.push(i);for(var o=0;o<r.length;o++)for(var l=0;l<r.length;l++)r[o]==r[l]&&r.splice(l,1);r.sort(function(){return-1});for(var s=0;s<r.length;s++){var d={date:"2017-"+t+"-"+r[s],state:"select"};parseInt(2*Math.random())&&(d.comment="备注"),d.state="select",e.push(d)}}),e},exChangeVal:function(t,e,n){t.on("click",function(){var t=e.val(),i=n.val();e.val(i),n.val(t)})},selectDate:function(t){if(void 0!==t){var e=t.el_trigger,n=t.el_popup,i=n.find(".cancel"),a=!1,r=function(){a||(a=!0,n.find(".date").datePicker({dateBase:"2017-10-10",weekend:!1,multiple:!1,gather:dataUtils.createData([10,11,12]),selectCallback:function(t){var e=t.selectData[0].date,a=e.year+"-"+e.month+"-"+e.day+"  "+e.week,r=new Date;r.getFullYear()==e.year&&r.getMonth()+1==e.month&&r.getDate()==e.day&&(a+="(今天)"),n.setPopupData(a),i.triggerHandler("click")}}))};e.on("click",function(){$(this);n.popup("modal",r,function(t){e.val(t),dataUtils.reSetWidth(e)})}).backtrack({cancel:n.selector+" .cancel"}),n.find(".cancel").on("click",function(){n.closePopup()})}},reSetWidth:function(t){var e=$("<div>"+t.val()+"</div>");e.css({position:"absolute",top:"-9999px",zIndex:-9999,paddingLeft:t.css("padding-left"),paddingRight:t.css("padding-right"),fontSize:t.css("font-size"),fontWeight:t.css("font-weight"),fontFamily:t.css("font-family")}),t.after(e);var n=(e.width()+10)/parseFloat($("html").css("font-size"))+"rem";t.width(n),e.remove()}},adrsUtils={targetType:isAndroid()?"tap":"click",selectAddress:function(t,e){var n,i=!1,a=t.el_trigger,r=t.el_popup;void 0===t||void 0===t.selectMode||"normal"===t.selectMode?a.on("click",function(){var t=$(this).find("input");r.popup("push",function(){i||(i=!0,setTimeout(function(){r.find(".wrapper").css("height",$(window).height()-44),n=new IScroll("#searchWrapper")},300))},function(e){t.val(e)})}):"mapMode"===t.selectMode||e(),r.find(".serach-input input").on("input",function(){var t=$(this),e=t.val().length,i="",a=$("#searchResult").siblings();""!=$.trim(t.val())?a.hide():a.show();for(var c=0;c<e;c++)i+='<li class="sui-border-b"><div class="sui-cell-map"><h1>'+c+"中交出行</h1><h2>深圳市南山区粤海街道科园路创业投资大厦8楼</h2></div></li>";$("#searchResult").html(i).children("li").off(adrsUtils.targetType).on(adrsUtils.targetType,function(){var t=$(this).find("h1").text();r.setPopupData(t),r.find(".cancel").triggerHandler("click")}),n&&n.refresh()}),r.find(".cancel").on("click",function(){r.closePopup(function(){n&&(n.destroy(),n=null)})}),r.find(".wrapper").find(".history span").on(adrsUtils.targetType,function(){var t=$(this).text();r.setPopupData(t),r.find(".cancel").triggerHandler("click")}),r.find(".wrapper").find(".current span").on(adrsUtils.targetType,function(){var t=$(this).text();r.setPopupData(t),r.find(".cancel").triggerHandler("click")}),r.find(".wrapper").find(".recommend span").on(adrsUtils.targetType,function(){var t=$(this).text();r.setPopupData(t),r.find(".cancel").triggerHandler("click")}),r.find(".remove-history").on("click",function(){r.find(".history").slideUp(300),setTimeout(function(){r.find(".history").find(".station-group").html("")},300)})},openCity:function(t){var e,n=!1;if(void 0!==t){var i=t.el_trigger,a=t.el_popup;i.on("click",function(){var t=$(this);a.popup("push",function(){n||(n=!0,setTimeout(function(){a.find(".wrapper").css("height",$(window).height()-44);var t=new IScroll("#cityWrapper");adrsUtils.retrieveWord(function(e){t.scrollToElement(e.attr("href"))})},300))},function(e){t.text(e)})}),a.find("#cityWrapper").find(".wrapper li").on(adrsUtils.targetType,function(){var t=$(this).text();a.setPopupData(t),a.find(".cancel").triggerHandler("click")}),a.find(".cancel").on("click",function(){a.closePopup(function(){e&&(e.destroy(),e=null)})})}},retrieveWord:function(t){var e=$(".nav-city"),n=e.find("li"),i=0;n.each(function(){i+=$(this).height()}),e.css("height",i),$(".nav-city a").on("click",function(e){e.preventDefault(),t instanceof Function&&t($(this))})}};