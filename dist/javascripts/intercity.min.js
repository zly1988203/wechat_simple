var _bgAdapt=!0;$(function(){var e=1.666666666666667;$("#tipRule").css("height",$(window).width()/e-30),window.onresize=function(){_bgAdapt&&$("#tipRule").css("height",$(window).width()/e-30)},$(".startWeekTime").on("click",function(){var e=$(this);initWeekTime(e)})});var zeroize=function(e){return e>9?e:"0"+e},getDate=function(e){return{text:zeroize(e.getMonth()+1)+"月"+zeroize(e.getDate())+"日",value:e.getFullYear()+"-"+zeroize(e.getMonth()+1)+"-"+zeroize(e.getDate())}},getTime=function(e,t){return{text:zeroize(e)+":"+zeroize(t),value:zeroize(e)+":"+zeroize(t)}},getNow=function(){var e=new Date((new Date).getTime());return e.setHours(e.getHours()+1),e.getMinutes()<30?e.setMinutes(30):e.setMinutes(60),e},filterHoursHours=function(e,t){for(var a,i=[],r=[],u="2017-09-22T",n=0;n<e.length;n++)a=e[n].split("~"),r.push([new Date(u+a[0]),new Date(u+a[1])]);for(var o=[],l=0;l<t.length;l++)a=t[l].value.split("~"),o.push([new Date(u+a[0]),new Date(u+a[1])]);for(var s=0;s<r.length;s++)for(var h=0;h<o.length;h++)o[h][0]>=r[s][0]&&o[h][0]<r[s][1]&&i.push(t[h]);return i};function getAddDays(e){var t=new Date((new Date).getTime()),a=t.getHours(),i=Number(t.getMinutes())+Number(e.data("intervalminute")),r=Math.floor(i/60);return Math.floor((a+r)/24)}function getAddHours(e){var t=new Date((new Date).getTime()),a=t.getHours(),i=Number(t.getMinutes())+Number(e.data("intervalminute"));return{hour:a=(a+Math.floor(i/60))%24,minute:i%60}}var initCityTimePicker=function(e){var t={},a=e;t.key=a.prop("id");var i=new Date,r=[],u=getAddDays(a),n=getDate(i).value;0==u?(r.push({value:getDate(i).value,text:"今天"}),i.setDate(i.getDate()+1)):(i.setDate(i.getDate()+u),n=getDate(i).value);for(var o=0;o<5;o++)r.push({value:getDate(i).value,text:getDate(i).text}),i.setDate(i.getDate()+1);t.day=r;var l,s,h,d=[];for(o=0;o<24;o++)l=getTime(o,0),s=getTime(o,30),h=getTime(o+1,0),d.push({value:l.value+"~"+s.value,text:l.text+"~"+s.text}),d.push({value:s.value+"~"+h.value,text:s.text+"~"+h.text});if(""!=$.trim(a.data("filter"))&&(d=filterHoursHours(a.data("filter").split(","),d)),3===$(this).data("level"))for(o=0;o<24;o++)o<10&&(o="0"+o),d.push({value:o,text:o+"点"});if(t.hour=d,t.minute=[{value:"",text:""}],3===a.data("level")){var g=[{value:"",text:""}];for(o=0;o<60;o++)o<10&&(o="0"+o),g.push({value:o,text:o+"分"});t.minute=g}i=getNow();t.data={day:getDate(i).value,hour:getTime(i.getHours(),i.getMinutes()).value,minute:""},a.val()&&(t.data={day:a.data("date"),hour:a.data("time"),minute:""}),t.onChange=function(e,i,r,u){if("day"===i){getNow();if(r.day.find(".selected").data("value")==n)r.hour.find("li").each(function(){if($(this).data("value")){var e=$(this).data("value").split("~")[0].split(":"),t=getAddHours(a);(e[0]<t.hour||e[0]==t.hour&&e[1]<t.minute)&&$(this).remove()}});else{var o="<li></li><li></li>",l=' class="selected"';$.each(t.hour,function(e,t){e>0&&(l=""),o+='<li data-value="'+t.value+'"'+l+">"+t.text+"</li>"}),o+="<li></li><li></li>",r.hour.find("ul").html(o)}u.hour&&(u.hour.refresh(),r.hour.find("ul").animate({translate:"0px,0px"},"fast","linear"))}},$.timePicker(t,function(e,t){t.hour&&(a.val(t.day+" "+t.hour.split("~")[0]),a.data("date",e.day),a.data("time",e.hour),"present_startTime"==a.attr("id")?showSharingCarPrice():showCharterCarType())})};function hideBackgroundImge(){_bgAdapt=!1,$("#tipRule").animate({height:"17px"},"fast",function(){$(".call-car-tip").remove(),$("body").css("background","none")})}