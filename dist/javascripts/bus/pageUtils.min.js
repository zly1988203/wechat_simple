var dataUtils={createData:function(t){var e=[];return t.forEach(function(t,i){for(var n=0,a=new Date(2017,t,0).getDate(),r=[],c=0;c<a;c++)(n=parseInt(10*Math.random().toFixed(2))+c+i)<=a&&r.push(n);for(var o=0;o<r.length;o++)for(var s=0;s<r.length;s++)r[o]==r[s]&&r.splice(s,1);r.sort(function(){return-1});for(var l=0;l<r.length;l++){var p={date:"2017-"+t+"-"+r[l],state:"select"};parseInt(2*Math.random())&&(p.comment="备注"),p.state="select",e.push(p)}}),e},exChangeVal:function(t,e,i){t.on("click",function(){var t=e.val(),n=i.val();e.val(n),i.val(t)})},selectDate:function(t){if(void 0!==t){var e=t.el_trigger,i=t.el_popup,n=i.find(".cancel"),a=!1,r=function(){a||(a=!0,i.find(".date").datePicker({dateBase:"2017-10-10",weekend:!1,multiple:!1,gather:dataUtils.createData([10,11,12]),selectCallback:function(t){var e=t.selectData[0].date,a=e.year+"-"+e.month+"-"+e.day+"  "+e.week,r=new Date;r.getFullYear()==e.year&&r.getMonth()+1==e.month&&r.getDate()==e.day&&(a+="(今天)"),i.setPopupData(a),n.triggerHandler("click")}}))};e.on("click",function(){$(this);i.popup("modal",r,function(t){e.val(t),dataUtils.reSetWidth(e)})}).backtrack({cancel:i.selector+" .cancel"}),i.find(".cancel").on("click",function(){i.closePopup()})}},reSetWidth:function(t){var e=$("<div>"+t.val()+"</div>");e.css({position:"absolute",top:"-9999px",zIndex:-9999,paddingLeft:t.css("padding-left"),paddingRight:t.css("padding-right"),fontSize:t.css("font-size"),fontWeight:t.css("font-weight"),fontFamily:t.css("font-family")}),t.after(e);var i=(e.width()+10)/parseFloat($("html").css("font-size"))+"rem";t.width(i),e.remove()}},adrsUtils={targetType:isAndroid()?"tap":"click",selectAddress:function(t,e){var i,n=!1,a=t.el_trigger,r=t.el_popup;void 0===t||void 0===t.selectMode||"normal"===t.selectMode?a.on("click",function(){var t=$(this).find("input");r.popup("push",function(){n||(n=!0,setTimeout(function(){r.find(".wrapper").css("height",$(window).height()-44),i=new IScroll("#searchWrapper")},300))},function(e){t.val(e)})}):"mapMode"===t.selectMode||e(),r.find(".search-input input").on("input",function(){var t=$(this),e=t.val().length,n="",a=$("#searchResult").siblings();""!=$.trim(t.val())?a.hide():a.show();for(var c=0;c<e;c++)n+='<li class="sui-border-b"><div class="sui-cell-map"><h1>'+c+"中交出行</h1><h2>深圳市南山区粤海街道科园路创业投资大厦8楼</h2></div></li>";$("#searchResult").html(n).show().children("li").off(adrsUtils.targetType).on(adrsUtils.targetType,function(){var t=$(this).find("h1").text();r.setPopupData(t),r.find(".cancel").triggerHandler("click")}),$("#searchResult").find("li").each(function(){var e=$(this).html();e=e.replace(t.val(),'<span style="color: #6392FE;">'+t.val()+"</span>"),$(this).html(e)}),i&&i.refresh()}),r.find(".cancel").on("click",function(){r.closePopup(function(){i&&(i.destroy(),i=null)})}),r.find(".wrapper").find(".history .address").on(adrsUtils.targetType,function(){var t=$(this).find(".address-name").text();r.setPopupData(t),r.find(".cancel").triggerHandler("click")}),r.find(".wrapper").find(".current span").on(adrsUtils.targetType,function(){var t=$(this).text();r.setPopupData(t),r.find(".cancel").triggerHandler("click")}),r.find(".wrapper").find(".recommend span").on(adrsUtils.targetType,function(){var t=$(this).text();r.setPopupData(t),r.find(".cancel").triggerHandler("click")}),r.find(".remove-history").on("click",function(){r.find(".history").slideUp(300),setTimeout(function(){r.find(".history").find(".station-group").html("")},300)})},openCity:function(t){var e,i=!1;if(void 0!==t){var n=t.el_trigger,a=t.el_popup;n.on("click",function(){var t=$(this);a.popup("push",function(){i||(i=!0,setTimeout(function(){a.find(".wrapper").css("height",$(window).height()-44);var t=new IScroll("#cityWrapper");adrsUtils.retrieveWord(function(e){t.scrollToElement(e.attr("href"))})},300))},function(e){t.text(e)})}),a.find("#cityWrapper").find(".wrapper li").on(adrsUtils.targetType,function(){var t=$(this).text();a.setPopupData(t),a.find(".cancel").triggerHandler("click")}),a.find("#cityWrapper").find(".wrapper .current-city span").on(adrsUtils.targetType,function(){var t=$(this).text();a.setPopupData(t),a.find(".cancel").triggerHandler("click")}),a.find(".cancel").on("click",function(){a.closePopup(function(){e&&(e.destroy(),e=null)}),a.find(".search-input input").val(""),a.find(".wrapper li").each(function(){$(this).show()})}),a.find(".search-input input").on("input",function(){var t=$(this).val();""!=(t=$.trim(t.toLowerCase()))&&null!=t?a.find(".wrapper li").each(function(){$(this).show(),$(this).text().indexOf(t)<=-1&&$(this).hide()}):a.find(".wrapper li").each(function(){$(this).show()})})}},retrieveWord:function(t){var e=$(".nav-city"),i=e.find("li"),n=0;i.each(function(){n+=$(this).height()}),e.css("height",n),$(".nav-city a").on("click",function(e){e.preventDefault();var i=$(this).text();$(".pop-special").text(i).fadeIn().css("opacity","0.6"),setTimeout(function(){$(".pop-special").fadeOut()},1200),t instanceof Function&&t($(this))})}};