<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>可用优惠券</title>
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0">
    <meta name="format-detection" content="telephone=no">
    <meta name="format-detection" content="email=no">
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <link href="../../dist/stylesheets/simpleui.min.css" rel="stylesheet" type="text/css">
    <link href="../../dist/stylesheets/base/vectors.2.css" rel="stylesheet" type="text/css">
    <link href="../../dist/stylesheets/my/coupon.css" rel="stylesheet" type="text/css">
</head>

<body>
    <div class="page">
        <div class="top">
            <div class="no-usering-coupon">
                <span>不使用优惠券</span>
            </div>
            <div class="rule-btn">
                <span>使用规则</span>
            </div>
        </div>
        <!--<div class="coupon-list">-->
            <!--&lt;!&ndash; 左边框颜色：blue，orange，green &ndash;&gt;-->
            <!--<div class="item blue">-->
                <!--<div class="left">-->
                    <!--<div class="main">-->
                        <!--<h4>城际班车券</h4>-->
                        <!--<p>有效期至2016-12-31</p>-->
                    <!--</div>-->
                    <!--<div class="info">限线路 深圳-珠海，湛江专线限线路 深圳-珠海，湛江专线限线路 深圳-珠海，湛江专线限线路 深圳-珠海，湛江专线</div>-->
                <!--</div>-->
                <!--<div class="right">-->
                    <!--<div class="main"><i>&yen;</i>2</div>-->
                    <!--<div class="info">满100元可使用</div>-->
                <!--</div>-->
            <!--</div>-->

            <!--<div class="item orange">-->
                <!--<div class="left">-->
                    <!--<div class="main">-->
                        <!--<h4>城际约租车</h4>-->
                        <!--<p>有效期至2016-12-31</p>-->
                    <!--</div>-->
                    <!--<div class="info">限线路 深圳-珠海，湛江专线</div>-->
                <!--</div>-->
                <!--<div class="right">-->
                    <!--<div class="main"><i>&yen;</i>5</div>-->
                    <!--<div class="info">满100元可使用</div>-->
                <!--</div>-->
            <!--</div>-->

            <!--<div class="item green">-->
                <!--<div class="left">-->
                    <!--<div class="main">-->
                        <!--<h4>出租车券</h4>-->
                        <!--<p>有效期至2016-12-31</p>-->
                    <!--</div>-->
                    <!--<div class="info">限线路 深圳-珠海，湛江专线限线路 深圳-珠海，湛江专线限线路 深圳-珠海，湛江专线限线路 深圳-珠海，湛江专线限线路 深圳-珠海，湛江专线</div>-->
                <!--</div>-->
                <!--<div class="right">-->
                    <!--<div class="main">9.5<i>折</i></div>-->
                    <!--<div class="info">最高抵扣10元</div>-->
                <!--</div>-->
            <!--</div>-->

        <!--</div>-->
    <!--</div>-->
    <!--优惠券列表-->
    <div class="coupon-list">
        <div class="coupon coupon01">
            <div class="coupon-top">
                <div class="coupon-top-left">
                    <div class="amount"><span>¥</span>1.0</div>
                    <div class="condition">满10元可用</div>
                </div>
                <div class="coupon-top-right">
                    <div class="coupon-type"><h4>城际约车</h4></div>
                    <div class="using-limit">有效期至：2018-08-10</div>
                </div>
            </div>
            <div class="coupon-middle"></div>
            <div class="coupon-bottom">
                <div class="using-condition"><p>.范围：适用于“城际巴士”业务中…</p></div>
                <div class="condition-detail" data-top="true">
                </div>
            </div>
        </div>
        <div class="coupon coupon02">
            <div class="coupon-top">
                <div class="coupon-top-left">
                    <div class="amount"><span>¥</span>22.2</div>
                    <div class="condition">不限制</div>
                </div>
                <div class="coupon-top-right">
                    <div class="coupon-type"><h4>通勤大巴券</h4></div>
                    <div class="using-limit">有效期至：2018-08-10</div>
                </div>
            </div>
            <div class="coupon-middle"></div>
            <div class="coupon-bottom">
                <div class="using-condition"><p>·范围：适用于“城际巴士”业务中：“深圳 - 东莞”</p><p>·不可与其他促销同享</p>
                </div>
                <div class="condition-detail" data-top="true">
                </div>
            </div>
        </div>
        <div class="coupon coupon03">
            <div class="coupon-top">
                <div class="coupon-top-left">
                    <div class="amount">7.5<span>折</span></div>
                    <div class="condition">最高抵扣5元</div>
                </div>
                <div class="coupon-top-right">
                    <div class="coupon-type"><h4>城际约车</h4></div>
                    <div class="using-limit">有效期至：2018-08-10</div>
                </div>
            </div>
            <div class="coupon-middle"></div>
            <div class="coupon-bottom">
                <div class="using-condition"><p>·范围：适用于“城际巴士”业务中：“深圳 - 东莞”</p><p>·“广州 - 深圳”全部线路</p><p>·不可与其他促销同享</p></div>
                <div class="condition-detail" data-top="true">
                </div>
            </div>
        </div>
        <div class="coupon coupon04">
            <div class="coupon-top">
                <div class="coupon-top-left">
                    <div class="amount">7.6<span>折</span></div>
                    <div class="condition">最高抵扣5元</div>
                </div>
                <div class="coupon-top-right">
                    <div class="coupon-type"><h4>城际约车</h4></div>
                    <div class="using-limit">有效期至：2018-08-10</div>
                </div>
            </div>
            <div class="coupon-middle"></div>
            <div class="coupon-bottom">
                <div class="using-condition"><p>·范围：适用于“城际巴士”业务中：“深圳 - 东莞”</p><p>·“广州 - 深圳”全部线路</p><p>·不可与其他促销同享</p></div>
                <div class="condition-detail" data-top="true">
                </div>
            </div>
        </div>
        <div class="coupon coupon05">
            <div class="coupon-top">
                <div class="coupon-top-left">
                    <div class="amount">7.7<span>折</span></div>
                    <div class="condition">最高抵扣5元</div>
                </div>
                <div class="coupon-top-right">
                    <div class="coupon-type"><h4>城际约车</h4></div>
                    <div class="using-limit">有效期至：2018-08-10</div>
                </div>
            </div>
            <div class="coupon-middle"></div>
            <div class="coupon-bottom">
                <div class="using-condition"><p>·范围：适用于“城际巴士”业务中：“深圳 - 东莞”,务中：“深圳 - 东莞”务中：“深圳 - 东莞”</p><p>·“广州 - 深圳”全部线路</p><p>·不可与其他促销同享</p></div>
                <div class="condition-detail" data-top="true">
                </div>
            </div>
        </div>
        <div class="coupon coupon06">
            <div class="coupon-top">
                <div class="coupon-top-left">
                    <div class="amount">7.8<span>折</span></div>
                    <div class="condition">最高抵扣5元</div>
                </div>
                <div class="coupon-top-right">
                    <div class="coupon-type"><h4>城际约车</h4></div>
                    <div class="using-limit">有效期至：2018-08-10</div>
                </div>
            </div>
            <div class="coupon-middle"></div>
            <div class="coupon-bottom">
                <div class="using-condition"><p>·范围：适用于“城际巴士”业务中：“深圳 - 东莞”</p><p>·“广州 - 深圳”全部线路</p><p>·不可与其他促销同享</p></div>
                <div class="condition-detail" data-top="true">
                </div>
            </div>
        </div>
        <div class="coupon coupon07">
            <div class="coupon-top">
                <div class="coupon-top-left">
                    <div class="amount">7.9<span>折</span></div>
                    <div class="condition">最高抵扣5元</div>
                </div>
                <div class="coupon-top-right">
                    <div class="coupon-type"><h4>城际约车</h4></div>
                    <div class="using-limit">有效期至：2018-08-10</div>
                </div>
            </div>
            <div class="coupon-middle"></div>
            <div class="coupon-bottom">
                <div class="using-condition"><p>·范围：111111适用于“城际巴士”业务中：“深圳 - 东莞”</p><p>·“广州 - 深圳”全部线路</p><p>·不可与其他促销同享</p></div>
                <div class="condition-detail" data-top="true">
                </div>
            </div>
        </div>
    </div>
    <div class="more-coupon">
        <span>下拉加载更多</span>
    </div>
    <div class="show-no-usering">
        <button type="button"><span>查看不可用优惠券</span></button>
    </div>

    <!--&lt;!&ndash; 没有优惠券 &ndash;&gt;-->
    <!--<div class="not-data" style="background-image: url(../../dist/images/common/icon_no_ticket.png);">您当前没有可用优惠券</div>-->
    <!-- 优惠券 - 使用规则 -->
    <div id="rule-content" class="sui-popup-container">
        <div class="sui-popup-mask"></div>
        <div class="sui-popup-modal">
            <div class="rule-content">
                <div class="close-popup close" data-target="ruleContent"></div>
                <h1>优惠券使用规则</h1>
                <P>缺少文案</P>
            </div>
        </div>
    </div>
    
    <script src="../../dist/javascripts/zepto.min.js"></script>
    <script src="../../dist/javascripts/simpleui.min.js"></script>
    <script src="../../dist/javascripts/common.min.js"></script>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js">
    </script><script src="../../src/js/my/coupon.js" type="text/javascript" ></script>
    <script>
        $(function() {
            //优惠券信息最多显示两行，然后显示更多，点击更多弹窗显示详情
            $('.coupon-list .item .left .info').each(function () {
                resetStringLength($(this));
            });

            // 显示使用规则
            $('.rule-btn span').on('click', function() {
                $('#ruleContent').popup('push');
            });

            /*
             *
             * 优惠券信息显示更多：
             *   获取两行文本可显示的长度，然后截取
             *
             * */
            function resetStringLength(obj) {
                //只计算一次
                if(!obj.data('resetStringLength')) {
                    //上锁
                    obj.data('resetStringLength', true);

                    //元素是否显示
                    if(obj.css('display') != 'none' && !obj.is(':hidden') && obj.is(':visible')) {
                        //存储旧数据
                        var objData = {
                            width: obj.width(),
                            fontSize:  parseFloat(obj.css('font-size').replace('px', '')),
                            text: obj.text()
                        };

                        //获取新长度，并重新填充数据
                        var newLength = objData.width / objData.fontSize * 2 - 6;

                        //少于两行的长度，则不裁剪
                        if(newLength > objData.text.length) {
                            return false;
                        }

                        var __more = $('<span>更多></span>');
                        obj.text(objData.text.slice(0, newLength) + '...');
                        obj.append(__more);

                        //阻止冒泡
                        obj.on('click', function (e) {
                            e.stopPropagation();
                        });

                        //查看更多
                        __more.on('click', function (e) {
                            //阻止冒泡
                            e.stopPropagation();

                            $.dialog({
                                title: '',
                                text: '',
                                html: '<p style="font-size: 16px; max-height: 300px; overflow-y: auto;">' + objData.text + '</p>',
                                autoClose: false,
                                buttons: [{
                                    text: '知道了',
                                    onClick: function() {
                                        $('.sui-mask').css('z-index', 1000);
                                        $.closeDialog();
                                    }
                                }]
                            });

                            $('.sui-mask').css('z-index', 8001);
                        });

                        return objData;
                    } else {
                        //解锁
                        obj.data('resetStringLength', false);

                        setTimeout(function () {
                            resetStringLength(obj);
                        }, 10);
                    }
                }
            }
        });
    </script>
</body>
</html>